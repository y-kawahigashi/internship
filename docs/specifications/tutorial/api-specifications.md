# API 仕様書

## 概要

このドキュメントでは、チュートリアルで提供する REST API の仕様について説明します。

## 目次

- [基本情報](#基本情報)
- [共通レスポンス形式](#共通レスポンス形式)
  - [成功レスポンス](#成功レスポンス)
  - [エラーレスポンス](#エラーレスポンス)
  - [エラータイプ](#エラータイプ)
  - [HTTP ステータスコード](#http-ステータスコード)
- [エンドポイント一覧](#エンドポイント一覧)
- [エンドポイント詳細](#エンドポイント詳細)
  - [GET /api/parrot](#get-apiparrot)
- [注意事項](#注意事項)

## 基本情報

- **ベース URL**: `/api`
- **リクエスト形式**: JSON
- **レスポンス形式**: JSON
- **文字エンコーディング**: UTF-8

## 共通レスポンス形式

### 成功レスポンス

すべての API は以下の形式でレスポンスを返します。

```json
{
  "data": {
    // エンドポイントごとのデータ
  }
}
```

### エラーレスポンス

エラーが発生した場合、以下の形式でレスポンスを返します。
※ fields はエラータイプが`INVALID_PARAMETER`の場合のみ

```json
{
  "error": {
    "message": "エラーメッセージ",
    "type": "エラータイプ",
    "fields": {
      "fieldName": "フィールドごとのエラーメッセージ"
    }
  }
}
```

#### エラータイプ

| エラータイプ            | 説明                       |
| ----------------------- | -------------------------- |
| `INVALID_PARAMETER`     | リクエストパラメータが不正 |
| `UNAUTHORIZED`          | 認証が必要                 |
| `FORBIDDEN`             | アクセス権限がない         |
| `NOT_FOUND`             | リソースが見つからない     |
| `INTERNAL_SERVER_ERROR` | サーバー内部エラー         |

#### HTTP ステータスコード

| ステータスコード | 説明                   |
| ---------------- | ---------------------- |
| 200              | 成功                   |
| 201              | 作成成功               |
| 400              | リクエストが不正       |
| 401              | 認証が必要             |
| 403              | アクセス権限がない     |
| 404              | リソースが見つからない |
| 500              | サーバー内部エラー     |

## エンドポイント一覧

| メソッド | エンドポイント                  | 説明       |
| -------- | ------------------------------- | ---------- |
| GET      | [`/api/parrot`](#get-apiparrot) | オウム返し |

## エンドポイント詳細

### GET /api/parrot

メッセージをオウム返しします。

#### リクエスト

**クエリパラメータ**

| パラメータ名 | 型     | 必須 | 説明                       |
| ------------ | ------ | ---- | -------------------------- |
| `message`    | string | ⚪︎  | ユーザー名（部分一致検索） |

**バリデーション**

| フィールド名 | エラー条件          | エラーメッセージ                          |
| ------------ | ------------------- | ----------------------------------------- |
| `message`    | 未指定の場合        | `"message is required"`                   |
| `message`    | 空文字列の場合      | `"message must be at least 1 character"`  |
| `message`    | 20 文字を超える場合 | `"message must be at most 20 characters"` |

**リクエスト例**

```bash
curl -X GET "http://localhost:3000/api/parrot?message=Hi!" \
  -H "Content-Type: application/json"
```

#### レスポンス

**成功時（200 OK）**

```json
{
  "data": {
    "message": "Hi!"
  }
}
```

**エラー時（400 Bad Request）**

```json
{
  "error": {
    "message": "Invalid query parameters",
    "type": "INVALID_PARAMETER",
    "fields": {
      "message": "message is required"
    }
  }
}
```

#### レスポンスデータ型

| フィールド名 | 型     | 説明               |
| ------------ | ------ | ------------------ |
| `message`    | string | 指定したメッセージ |

---

## 注意事項

1. **エラーハンドリング**: エラーが発生した場合、適切な HTTP ステータスコードとエラー情報が返されます
2. **バリデーション**: リクエストパラメータはすべてバリデーションされます。不正な値が含まれている場合、エラーレスポンスが返されます
